<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- ËøêË°åËÆ∞ÂΩïË°®Ê†ºÁâáÊÆµ -->
    <div th:fragment="runs-table">
        <div class="card">
            <div class="card-body">
                <table class="table" th:if="${runs != null and !runs.empty}">
                    <thead>
                        <tr>
                            <th>ËøêË°åID</th>
                            <th>‰ªìÂ∫ì</th>
                            <th>PR</th>
                            <th>Âπ≥Âè∞</th>
                            <th>ÊÄªÂàÜ</th>
                            <th>ÂàõÂª∫Êó∂Èó¥</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="run : ${runs}">
                            <td>
                                <code class="text-small" th:text="${#strings.abbreviate(run.runId, 12)}">run-001</code>
                            </td>
                            <td>
                                <a th:href="@{'https://github.com/' + ${run.repoOwner} + '/' + ${run.repoName}}" 
                                   target="_blank"
                                   class="text-primary">
                                    <span th:text="${run.repoOwner + '/' + run.repoName}">user/repo</span>
                                </a>
                            </td>
                            <td>
                                <div>
                                    <span class="badge badge-secondary" th:text="'#' + ${run.pullNumber}">#123</span>
                                </div>
                                <div class="text-small text-muted mt-1" th:text="${#strings.abbreviate(run.pullTitle, 30)}">
                                    PRÊ†áÈ¢ò
                                </div>
                            </td>
                            <td>
                                <span class="badge badge-info" th:text="${run.platform}">GitHub</span>
                            </td>
                            <td>
                                <span class="badge" 
                                      th:classappend="${run.totalScore >= 90 ? 'badge-success' : (run.totalScore >= 70 ? 'badge-warning' : 'badge-error')}"
                                      th:text="${#numbers.formatDecimal(run.totalScore, 1, 1)}">
                                    85.5
                                </span>
                            </td>
                            <td class="text-small text-muted">
                                <time th:text="${#temporals.format(run.createdAt, 'MM-dd HH:mm')}">
                                    01-15 10:30
                                </time>
                            </td>
                            <td>
                                <a th:href="@{'/runs/' + ${run.runId}}" 
                                   class="btn btn-outline btn-sm">
                                    Êü•ÁúãËØ¶ÊÉÖ
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- Á©∫Áä∂ÊÄÅ -->
                <div th:if="${runs == null or runs.empty}" class="text-center text-muted" style="padding: 3rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üìã</div>
                    <h3>ÊöÇÊó†ËøêË°åËÆ∞ÂΩï</h3>
                    <p>ËøòÊ≤°Êúâ‰ªª‰Ωï‰ª£Á†ÅËØÑÂÆ°ËøêË°åËÆ∞ÂΩï</p>
                </div>
            </div>
        </div>
        
        <!-- ÂàÜÈ°µ -->
        <div th:if="${runs != null and !runs.empty}" class="pagination">
            <button type="button" 
                    class="btn btn-secondary"
                    th:disabled="${!hasPrevious}"
                    hx-get="/dashboard/page"
                    th:hx-vals="'{\"page\": ' + ${currentPage - 1} + ', \"size\": ' + ${pageSize} + ', \"repo\": \"' + ${repoFilter} + '\", \"platform\": \"' + ${platformFilter} + '\"}'"
                    hx-target="#runs-table-container"
                    hx-indicator="#loading-indicator">
                ‚Üê ‰∏ä‰∏ÄÈ°µ
            </button>
            
            <span class="page-info">
                Á¨¨ <span th:text="${currentPage + 1}">1</span> È°µÔºåÂÖ± <span th:text="${totalPages}">1</span> È°µ
                ÔºàÂÖ± <span th:text="${totalElements}">0</span> Êù°ËÆ∞ÂΩïÔºâ
            </span>
            
            <button type="button" 
                    class="btn btn-secondary"
                    th:disabled="${!hasNext}"
                    hx-get="/dashboard/page"
                    th:hx-vals="'{\"page\": ' + ${currentPage + 1} + ', \"size\": ' + ${pageSize} + ', \"repo\": \"' + ${repoFilter} + '\", \"platform\": \"' + ${platformFilter} + '\"}'"
                    hx-target="#runs-table-container"
                    hx-indicator="#loading-indicator">
                ‰∏ã‰∏ÄÈ°µ ‚Üí
            </button>
        </div>
    </div>
    
    <!-- ÈîôËØØÁâáÊÆµ -->
    <div th:fragment="error">
        <div class="card">
            <div class="card-body">
                <div class="text-center text-muted" style="padding: 3rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
                    <h3>Âä†ËΩΩÂ§±Ë¥•</h3>
                    <p th:text="${error}">Êï∞ÊçÆÂä†ËΩΩÂá∫Áé∞ÈóÆÈ¢òÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï</p>
                    <button onclick="location.reload()" class="btn btn-primary mt-2">Âà∑Êñ∞È°µÈù¢</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
